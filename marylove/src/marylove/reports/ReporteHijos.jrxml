<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="report name" pageWidth="842" pageHeight="595" orientation="Landscape" columnWidth="802" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" uuid="71373fdd-bbe7-4b4d-bb27-9e96cc9d9cc5">
	<property name="ireport.zoom" value="1.0"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="39"/>
	<parameter name="anio" class="java.lang.Integer">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<queryString>
		<![CDATA[SELECT
 p.persona_nombre||' '|| p.persona_apellido AS "Compañera",
 
 (SELECT
 COUNT(*)
 FROM
 hijos h 
 WHERE
 h.victima_codigo =v.victima_codigo) AS "NNA Responsables",
 (CASE
 WHEN  p1.persona_nombre || ' '||p1.persona_apellido  IS NULL THEN ''
 ELSE p1.persona_nombre || ' '||p1.persona_apellido
 END)
 AS " NNA",
 (CASE
 WHEN p1.persona_sexo IS NULL THEN ''
 ELSE p1.persona_sexo||''
 END) AS "Sexo" ,
 (CASE
 WHEN p1.persona_fecha_nac  IS NULL THEN ''
 ELSE p1.persona_fecha_nac||''
 END) AS "Fecha de Nacimiento" ,
 (CASE
 WHEN  ((current_date-p1.persona_fecha_nac)/365)  IS NULL THEN ''
 ELSE ((current_date-p1.persona_fecha_nac)/365)||''
 END) AS "Años" ,
 (CASE
 WHEN  h.hijo_anioescolar IS NULL THEN ''
 ELSE  h.hijo_anioescolar||''
 END) AS "Año Escolar" ,
 (CASE
 WHEN ie.inst_nombre IS NULL THEN ''
 ELSE ie.inst_nombre||''
 END) AS "Institucion Educativa" 

 FROM
 persona p
 JOIN 
 victima v
 ON 
 v.persona_codigo = p.persona_codigo
 LEFT JOIN
 ingreso i
 ON 
 i.victima_codigo = v.victima_codigo
 LEFT JOIN
 egreso e
 ON
 e.victima_codigo = v.victima_codigo
 LEFT JOIN
 direccion_persona dp
 ON
 p.persona_codigo = dp.persona_codigo
 LEFT JOIN 
 direccion d
 ON 
 d.dir_codigo = dp.dir_domicilio
 LEFT JOIN  hijos h
 ON h.victima_codigo = v.victima_codigo
 LEFT JOIN persona p1
 ON p1.persona_codigo = h.persona_codigo
 LEFT JOIN 
 institucion_educativa ie
 ON ie.inst_codigo = h.institucion_codigo
 LEFT JOIN registro_referencia rr
 ON
 v.victima_codigo = rr.victima_codigo
 LEFT  JOIN x_registro_agresor xra
 ON
 xra.registroreferencia_codigo =rr.registroreferencia_codigo 
LEFT JOIN 
 agresor a
 ON a.agresor_codigo = xra.agresor_codigo
 WHERE extract (year from i.ingreso_fecha) =2017
 ORDER BY 
 v.victima_codigo, i.ingreso_fecha]]>
	</queryString>
	<field name="Compañera" class="java.lang.String"/>
	<field name="NNA Responsables" class="java.lang.Long"/>
	<field name=" NNA" class="java.lang.String"/>
	<field name="Sexo" class="java.lang.String"/>
	<field name="Fecha de Nacimiento" class="java.lang.String"/>
	<field name="Años" class="java.lang.String"/>
	<field name="Año Escolar" class="java.lang.String"/>
	<field name="Institucion Educativa" class="java.lang.String"/>
	<background>
		<band splitType="Stretch"/>
	</background>
	<title>
		<band height="70" splitType="Stretch">
			<staticText>
				<reportElement x="0" y="10" width="802" height="46" uuid="b547878d-e5e2-498c-ba7e-3002c94cda52"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="18" isBold="true"/>
				</textElement>
				<text><![CDATA[Reporte General de los hijos de las compañeras]]></text>
			</staticText>
		</band>
	</title>
	<pageHeader>
		<band height="22" splitType="Stretch"/>
	</pageHeader>
	<columnHeader>
		<band height="82" splitType="Stretch">
			<staticText>
				<reportElement x="144" y="2" width="22" height="70" uuid="328d2328-fdd7-4a10-8e01-23137839c9f1"/>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="Left"/>
				<text><![CDATA[# NNA]]></text>
			</staticText>
			<staticText>
				<reportElement x="178" y="2" width="16" height="70" uuid="4465fb7e-ae59-404d-b7ae-90b45e3eb29e"/>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="Left"/>
				<text><![CDATA[ NNA]]></text>
			</staticText>
			<staticText>
				<reportElement x="344" y="2" width="20" height="70" uuid="05cd6f29-6e2b-4f51-83b0-dabeb31db8ac"/>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="Left"/>
				<text><![CDATA[F.Nacimiento]]></text>
			</staticText>
			<staticText>
				<reportElement x="451" y="2" width="15" height="70" uuid="2001839d-524c-4e4a-8fba-742a74188d09"/>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="Left"/>
				<text><![CDATA[Años]]></text>
			</staticText>
			<staticText>
				<reportElement x="508" y="2" width="18" height="70" uuid="2bff7628-cfae-4342-99b2-68c12dc98e20"/>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="Left"/>
				<text><![CDATA[Año Escolar]]></text>
			</staticText>
			<staticText>
				<reportElement x="637" y="2" width="34" height="70" uuid="80c97c70-078a-4395-a763-fa9913d7fb2a"/>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="Left"/>
				<text><![CDATA[Institucion Educativa]]></text>
			</staticText>
			<staticText>
				<reportElement x="299" y="2" width="15" height="70" uuid="ce597e64-87cb-4907-89d5-de509cb02a99"/>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="Left"/>
				<text><![CDATA[Sexo]]></text>
			</staticText>
			<staticText>
				<reportElement mode="Transparent" x="10" y="0" width="21" height="72" uuid="a1b9748a-4b97-441d-9d02-2346502fe0fa"/>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="Left" markup="none"/>
				<text><![CDATA[Compañera]]></text>
			</staticText>
		</band>
	</columnHeader>
	<detail>
		<band height="53" splitType="Stretch">
			<textField>
				<reportElement x="10" y="0" width="123" height="20" uuid="30a29659-56c2-4e34-8ec6-7037b6968b37"/>
				<textElement verticalAlignment="Middle"/>
				<textFieldExpression><![CDATA[$F{Compañera}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="144" y="0" width="22" height="20" uuid="9b23578e-ed4e-451b-a049-962de5725737"/>
				<textElement verticalAlignment="Middle"/>
				<textFieldExpression><![CDATA[$F{NNA Responsables}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="178" y="0" width="111" height="20" uuid="49c292a7-7ca4-4b48-a76e-7d16e173265f"/>
				<textElement verticalAlignment="Middle"/>
				<textFieldExpression><![CDATA[$F{ NNA}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="299" y="0" width="34" height="20" uuid="915ec2c3-437c-4a3d-aab6-72c97b2fd551"/>
				<textElement verticalAlignment="Middle"/>
				<textFieldExpression><![CDATA[$F{Sexo}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="344" y="0" width="95" height="20" uuid="11e75e09-ab78-4179-b75f-c1775bd0bc2d"/>
				<textElement verticalAlignment="Middle"/>
				<textFieldExpression><![CDATA[$F{Fecha de Nacimiento}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="451" y="0" width="45" height="20" uuid="710ba00b-487d-4382-8e0c-a1e98878bec2"/>
				<textElement verticalAlignment="Middle"/>
				<textFieldExpression><![CDATA[$F{Años}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="508" y="0" width="118" height="20" uuid="6630be98-d5b3-4693-9da6-be6b3a4c2d92"/>
				<textElement verticalAlignment="Middle"/>
				<textFieldExpression><![CDATA[$F{Año Escolar}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="637" y="0" width="118" height="20" uuid="782535ed-372e-4d8b-b905-e83fb1b77243"/>
				<textElement verticalAlignment="Middle"/>
				<textFieldExpression><![CDATA[$F{Institucion Educativa}]]></textFieldExpression>
			</textField>
			<line>
				<reportElement x="0" y="34" width="802" height="1" uuid="65adf4c3-2489-401a-a64a-c611f35372c0"/>
			</line>
		</band>
	</detail>
	<columnFooter>
		<band height="45" splitType="Stretch"/>
	</columnFooter>
	<pageFooter>
		<band height="54" splitType="Stretch">
			<textField>
				<reportElement x="696" y="34" width="69" height="20" uuid="684a0cf2-d9fd-4f57-9d73-ff58a0fe16bb"/>
				<textElement textAlignment="Right"/>
				<textFieldExpression><![CDATA["Página "+$V{PAGE_NUMBER}+" de "]]></textFieldExpression>
			</textField>
			<textField evaluationTime="Report">
				<reportElement x="765" y="34" width="37" height="20" uuid="167f8474-cf74-4c81-b4b0-829fa4f1d189"/>
				<textFieldExpression><![CDATA[" " + $V{PAGE_NUMBER}]]></textFieldExpression>
			</textField>
		</band>
	</pageFooter>
	<summary>
		<band height="42" splitType="Stretch"/>
	</summary>
</jasperReport>
