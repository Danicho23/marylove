<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="report name" pageWidth="842" pageHeight="595" orientation="Landscape" columnWidth="802" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" uuid="3c451122-db93-49a1-8871-2729c1984135">
	<property name="ireport.zoom" value="1.0"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<queryString>
		<![CDATA[SELECT
 p.persona_nombre||' '|| p.persona_apellido AS "Compañera",
 (CASE
 WHEN  i.ingreso_fecha  IS NULL THEN ''
 ELSE i.ingreso_fecha||''
 END) AS "Fecha Ingreso" ,
 (CASE
 WHEN  e.egreso_fecha  IS NULL THEN ''
 ELSE e.egreso_fecha||''
 END) AS "Fecha Egreso" ,
 (select par_valores->xra.parentesco->>'valor' from parametros where par_id = 9) AS "Agresor",
 (select par_valores->p.persona_nacionalidad->>'valor' from parametros where par_id = 3) AS "Nacionalidad",
 (CASE
 WHEN d.dir_provincia  IS NULL THEN ''
 ELSE d.dir_provincia||''
 END) AS "Provincia" ,
 (CASE
 WHEN d.dir_ciudad  IS NULL THEN ''
 ELSE d.dir_ciudad||''
 END) AS "Ciudad" ,
 (CASE
 WHEN d.dir_parroquia  IS NULL THEN ''
 ELSE d.dir_parroquia||''
 END) AS "Parroquia" ,
 (CASE
 WHEN  ((current_date-p.persona_fecha_nac)/365)  IS NULL THEN ''
 ELSE ((current_date-p.persona_fecha_nac)/365)||''
 END) AS "Años" ,
 (select par_valores->p.persona_nivel_acad->>'valor' from parametros where par_id = 5) AS "Instruccion",
 (select par_valores->p.persona_ocupacion->>'valor' from parametros where par_id = 7) AS "Ocupacion",
 (select par_valores->p.persona_estadocivil->>'valor' from parametros where par_id = 4) AS "Estado Civil",
 (SELECT
 COUNT(*)
 FROM
 hijos h 
 WHERE
 h.victima_codigo =v.victima_codigo) AS "NNA Responsables"
 FROM
 persona p
 JOIN 
 victima v
 ON 
 v.persona_codigo = p.persona_codigo
 LEFT JOIN
 ingreso i
 ON 
 i.victima_codigo = v.victima_codigo
 LEFT JOIN
 egreso e
 ON
 e.victima_codigo = v.victima_codigo
 LEFT JOIN
 direccion_persona dp
 ON
 p.persona_codigo = dp.persona_codigo
 LEFT JOIN 
 direccion d
 ON 
 d.dir_codigo = dp.dir_domicilio
 LEFT JOIN  hijos h
 ON h.victima_codigo = v.victima_codigo
 LEFT JOIN persona p1
 ON p1.persona_codigo = h.persona_codigo
 LEFT JOIN 
 institucion_educativa ie
 ON ie.inst_codigo = h.institucion_codigo
 LEFT JOIN registro_referencia rr
 ON
 v.victima_codigo = rr.victima_codigo
 LEFT  JOIN x_registro_agresor xra
 ON
 xra.registroreferencia_codigo =rr.registroreferencia_codigo 
LEFT JOIN 
 agresor a
 ON a.agresor_codigo = xra.agresor_codigo

 ORDER BY 
 v.victima_codigo, i.ingreso_fecha]]>
	</queryString>
	<field name="Compañera" class="java.lang.String"/>
	<field name="Fecha Ingreso" class="java.lang.String"/>
	<field name="Fecha Egreso" class="java.lang.String"/>
	<field name="Agresor" class="java.lang.String"/>
	<field name="Nacionalidad" class="java.lang.String"/>
	<field name="Provincia" class="java.lang.String"/>
	<field name="Ciudad" class="java.lang.String"/>
	<field name="Parroquia" class="java.lang.String"/>
	<field name="Años" class="java.lang.String"/>
	<field name="Instruccion" class="java.lang.String"/>
	<field name="Ocupacion" class="java.lang.String"/>
	<field name="Estado Civil" class="java.lang.String"/>
	<field name="NNA Responsables" class="java.lang.Long"/>
	<background>
		<band splitType="Stretch"/>
	</background>
	<title>
		<band height="47" splitType="Stretch">
			<staticText>
				<reportElement x="0" y="0" width="802" height="45" uuid="4177e4f0-501e-489d-a629-dfbc4d1f1469"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="16" isBold="true"/>
				</textElement>
				<text><![CDATA[Reporte General de las Compañeras]]></text>
			</staticText>
		</band>
	</title>
	<pageHeader>
		<band height="25" splitType="Stretch"/>
	</pageHeader>
	<columnHeader>
		<band height="95" splitType="Stretch">
			<staticText>
				<reportElement x="0" y="0" width="20" height="83" uuid="e963dbae-1d9d-46a9-88a1-583e8b2e3d0e"/>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="Left"/>
				<text><![CDATA[Compañera]]></text>
			</staticText>
			<staticText>
				<reportElement x="100" y="0" width="16" height="79" uuid="1ca7a6ff-36d2-4929-b1bb-dca868abbaa2"/>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="Left"/>
				<text><![CDATA[Fecha Ingreso]]></text>
			</staticText>
			<staticText>
				<reportElement x="160" y="0" width="20" height="79" uuid="59cbd0b6-115a-4c32-8fc4-32c3c84a7ec9"/>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="Left"/>
				<text><![CDATA[Fecha Egreso]]></text>
			</staticText>
			<staticText>
				<reportElement x="218" y="0" width="18" height="79" uuid="1ed171f7-7521-418a-8e8d-8161762f5285"/>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="Left"/>
				<text><![CDATA[Agresor]]></text>
			</staticText>
			<staticText>
				<reportElement x="280" y="0" width="18" height="79" uuid="429235fb-1c7e-4268-bd47-04fe4b84ecf0"/>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="Left"/>
				<text><![CDATA[Nacionalidad]]></text>
			</staticText>
			<staticText>
				<reportElement x="333" y="0" width="20" height="81" uuid="d00ce956-45e9-444b-a3ed-f79a9e79c696"/>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="Left"/>
				<text><![CDATA[Provincia]]></text>
			</staticText>
			<staticText>
				<reportElement x="399" y="0" width="20" height="79" uuid="bfedefb8-ec5b-48e5-9bf8-e94df8a86046"/>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="Left"/>
				<text><![CDATA[Ciudad]]></text>
			</staticText>
			<staticText>
				<reportElement x="469" y="0" width="20" height="79" uuid="a18b3100-ed3f-478d-a4c5-5b1aa9d9bbe9"/>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="Left"/>
				<text><![CDATA[Parroquia]]></text>
			</staticText>
			<staticText>
				<reportElement x="527" y="0" width="15" height="79" uuid="911ab835-a184-4b72-8b15-a041e0810ec5"/>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="Left"/>
				<text><![CDATA[Años]]></text>
			</staticText>
			<staticText>
				<reportElement x="665" y="0" width="16" height="81" uuid="2121914e-1044-464f-a30e-1837b7f7292c"/>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="Left"/>
				<text><![CDATA[Ocupacion]]></text>
			</staticText>
			<staticText>
				<reportElement x="714" y="0" width="20" height="81" uuid="f2a05a3c-9c42-4f66-a75d-ddaf6f0298dd"/>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="Left"/>
				<text><![CDATA[Estado Civil]]></text>
			</staticText>
			<staticText>
				<reportElement x="782" y="0" width="20" height="77" uuid="4ec60cae-6871-401b-a11b-b5ab44577ad5"/>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="Left"/>
				<text><![CDATA[NNA Responsables]]></text>
			</staticText>
			<staticText>
				<reportElement x="542" y="0" width="19" height="79" uuid="8a8d8fb8-57f0-44e3-95ca-052a0d60a95e"/>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="Left"/>
				<text><![CDATA[Instruccion]]></text>
			</staticText>
		</band>
	</columnHeader>
	<detail>
		<band height="38" splitType="Stretch">
			<textField>
				<reportElement x="0" y="0" width="100" height="20" uuid="8f134924-6ca3-4819-a0ba-2929c4fe42c9"/>
				<textElement verticalAlignment="Middle"/>
				<textFieldExpression><![CDATA[$F{Compañera}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="100" y="0" width="49" height="20" uuid="70661a2b-6101-4028-b03a-fa46bdcfacf5"/>
				<textElement verticalAlignment="Middle"/>
				<textFieldExpression><![CDATA[$F{Fecha Ingreso}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="160" y="0" width="58" height="20" uuid="4797a6c8-bf57-4830-bc46-867b23dabcb3"/>
				<textElement verticalAlignment="Middle"/>
				<textFieldExpression><![CDATA[$F{Fecha Egreso}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="218" y="0" width="62" height="20" uuid="75b82315-9864-4b28-8116-778a368b120a"/>
				<textElement verticalAlignment="Middle"/>
				<textFieldExpression><![CDATA[$F{Agresor}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="280" y="0" width="47" height="20" uuid="e92871a7-7ddb-49e7-b9dd-7d0f896f0165"/>
				<textElement verticalAlignment="Middle"/>
				<textFieldExpression><![CDATA[$F{Nacionalidad}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="333" y="0" width="66" height="20" uuid="ef2260fb-6a45-4410-be91-18a46f2b24e8"/>
				<textElement verticalAlignment="Middle"/>
				<textFieldExpression><![CDATA[$F{Provincia}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="399" y="0" width="58" height="20" uuid="1959c717-43c3-4077-a988-c8548ca5fc1e"/>
				<textElement verticalAlignment="Middle"/>
				<textFieldExpression><![CDATA[$F{Ciudad}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="457" y="0" width="70" height="20" uuid="7a9a74fb-8a38-4ec9-aa26-3c0f6f91d0a3"/>
				<textElement verticalAlignment="Middle"/>
				<textFieldExpression><![CDATA[$F{Parroquia}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="527" y="0" width="13" height="20" uuid="241e90f2-675e-4089-aa5e-3e22a8714a44"/>
				<textElement verticalAlignment="Middle"/>
				<textFieldExpression><![CDATA[$F{Años}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="542" y="1" width="118" height="20" uuid="bb050fe9-208e-47ef-ada2-bde86bd63894"/>
				<textElement verticalAlignment="Middle"/>
				<textFieldExpression><![CDATA[$F{Instruccion}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="665" y="0" width="49" height="20" uuid="9a40e77e-a0ad-4bb9-aa5b-a494dee952cc"/>
				<textElement verticalAlignment="Middle" rotation="None"/>
				<textFieldExpression><![CDATA[$F{Ocupacion}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="714" y="0" width="68" height="19" uuid="75b9329d-b4be-4f91-b166-0afbbc3f2f92"/>
				<textElement verticalAlignment="Middle" rotation="None"/>
				<textFieldExpression><![CDATA[$F{Estado Civil}]]></textFieldExpression>
			</textField>
			<line>
				<reportElement x="0" y="32" width="802" height="1" uuid="052822c7-755b-479b-b1db-cfd9fafb8c78"/>
			</line>
			<textField>
				<reportElement x="782" y="0" width="20" height="20" uuid="7771e64a-6cc6-4142-95db-c01953dc9fc9"/>
				<textElement verticalAlignment="Middle"/>
				<textFieldExpression><![CDATA[$F{NNA Responsables}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<columnFooter>
		<band height="45" splitType="Stretch"/>
	</columnFooter>
	<pageFooter>
		<band height="54" splitType="Stretch">
			<textField>
				<reportElement x="701" y="34" width="68" height="20" uuid="0dd21e60-1e76-407d-890a-885a89b9c146"/>
				<textElement textAlignment="Right"/>
				<textFieldExpression><![CDATA["Página "+$V{PAGE_NUMBER}+" de "]]></textFieldExpression>
			</textField>
			<textField evaluationTime="Report">
				<reportElement x="769" y="34" width="33" height="20" uuid="f7f2437d-6f99-424d-9683-06707baffc68"/>
				<textFieldExpression><![CDATA[" " + $V{PAGE_NUMBER}]]></textFieldExpression>
			</textField>
		</band>
	</pageFooter>
	<summary>
		<band height="42" splitType="Stretch"/>
	</summary>
</jasperReport>
